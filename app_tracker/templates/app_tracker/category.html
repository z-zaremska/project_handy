{% extends 'base.html' %}

{% block content %}

    <h1>Category: <i>{{category.name}}</i></h1>
    <ul>
        <li><a href="{% url 'app_tracker:category_edit' category.id %}">Edit category</a>
        <li><a href="{% url 'app_tracker:category_delete' category.id %}">Delete category</a>
    </ul>

    {% if category_all_logs %}
        <center>    
            {{category_chart|safe}}
            <h4>({{interval_start}} - {{interval_end}})</h4>
        </center>

        <center>
            <form method="GET" action="{% url 'app_tracker:category' category.id %}">
                From {{chart_interval_form.adjust_interval_start}} to {{chart_interval_form.adjust_interval_end}}<br>
                <input type="submit" value="Set time interval">
            </form>
            <form method="GET" action="{% url 'app_tracker:category' category.id %}">
                <input type="hidden" name="adjust_interval_start" value="reset">
                <input type="hidden" name="adjust_interval_end" value="reset">
                <input type="submit" value="Reset">
            </form>
        </center>
    {% endif %}
    
    <p><b>Description:</b> {{category.description}}</p>

    <p><b>All time:</b> {{category.total_time}}</p>

    <b>All category activities:</b>
    <table border callpadding="10">
        <tr align='center' valign='middle'>
            <th>No.</th>
            <th>Activity</th>
            <th>Color</th>
            <th>Total time</th>
            <th>Last activity</th>
        </tr align='center' valign='middle'>
        {% if category_all_activities %}
            {% for activity in category_all_activities %}
            <tr>
                <th scope='row'>{{ forloop.counter }}</th>
                <td><a href="{% url 'app_tracker:activity' activity.id %}">{{activity.name}}</a></td>
                <td style="color:{{activity.color}}">{{activity.color}}</td>
                <td>
                    {% if activity.total_time %}
                        {{activity.total_time}}
                    {% else %}
                     -
                    {% endif %}
                </td>
                <td>
                    {% if activity.last_log %}
                        {{activity.last_log.date|date:'Y-m-d'}} - <i>{{activity.last_log.start_time|time:"H:i"}}</i>
                    {% else %}
                        <i>no activities yet</i>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        {% endif %}                
        <tr align='center' valign='middle'>
            <form method="POST">
                {% csrf_token %}
                <th>+</th>
                <td><input type="text" id="name" name="name"></td>
                <td>
                    <select name="color" id="color"><br>
                        <option value="gray">gray</option>
                        <option value="yellow">yellow</option>
                        <option value="purple">purple</option>
                        <option value="orange">orange</option>
                        <option value="blue">blue</option>
                        <option value="green">green</option>
                        <option value="black">black</option>
                    </select>
                </td>
                <td colspan="2"><input type="submit" value="Create new activity"></td>            
            </form>
        </tr>
    </table>

{% endblock content %}